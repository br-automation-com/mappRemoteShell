{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"index.html","text":"Introduction This is a sample project to execute a shell command on a remote PC. The remote command is executed with a Python script that connects via OPC UA to the B&R PLC. The PLC only needs the variable structure to execute a command and some code to indicate the connection status. The sample uses a mappView visualization for demo purpose but mappView is not required to run the sample. The variable structure mappRemoteShell has the following members: Variable Description execute Starts the remote command. The Python script resets this variable when the command is finished. command The shell command string that is excecuted on the remote PC alive_counter This counter is used to detect the connection state connected Indicates that the remote PC is connected and ready to receive a command status The status of the command The following status codes show the state of the command Code Description 65535 The command is still busy 10000 Generic command error 10001 The command was not found 10002 The response data is larger than the response string on the PLC 0 The command was successful Python Script PLC UI The Python script can run on any system that supports the Python framework. The logger gives a detailed feedback about the connection status and executed command. The option for balloon messages will show a notification every time a command is executed. Auto reconnect will automatically connect when the script is started or when the connection was interrupted. Start minimized will put the application into the system tray on startup. If the command produces response data the script will transfer this data back to PLC. If the command generates an error the error message will be sent back as response to the PLC. Requirements Automation Studio 4.7 Automation Runtime C4.72 Python 3.8 or higher Recommended task class is #8 with a 10ms cycle time.","title":"Start"},{"location":"index.html#introduction","text":"This is a sample project to execute a shell command on a remote PC. The remote command is executed with a Python script that connects via OPC UA to the B&R PLC. The PLC only needs the variable structure to execute a command and some code to indicate the connection status. The sample uses a mappView visualization for demo purpose but mappView is not required to run the sample. The variable structure mappRemoteShell has the following members: Variable Description execute Starts the remote command. The Python script resets this variable when the command is finished. command The shell command string that is excecuted on the remote PC alive_counter This counter is used to detect the connection state connected Indicates that the remote PC is connected and ready to receive a command status The status of the command The following status codes show the state of the command Code Description 65535 The command is still busy 10000 Generic command error 10001 The command was not found 10002 The response data is larger than the response string on the PLC 0 The command was successful Python Script PLC UI The Python script can run on any system that supports the Python framework. The logger gives a detailed feedback about the connection status and executed command. The option for balloon messages will show a notification every time a command is executed. Auto reconnect will automatically connect when the script is started or when the connection was interrupted. Start minimized will put the application into the system tray on startup. If the command produces response data the script will transfer this data back to PLC. If the command generates an error the error message will be sent back as response to the PLC.","title":"Introduction"},{"location":"index.html#requirements","text":"Automation Studio 4.7 Automation Runtime C4.72 Python 3.8 or higher Recommended task class is #8 with a 10ms cycle time.","title":"Requirements"},{"location":"import.html","text":"This guide shows how to import the demo project into an existing project. The screenshots can look slightly different depending on the version used. Copy task to new project Open the demo project and the exiting project side by side. Go to the logical view in both projects. Copy the package mappRemoteShell from the demo project. Paste the task into the existing project at the top. Assign the new task to the CPU. The task is assign to task class #4 by default. Recommended task class is #8. Enable OPC UA configuration Make sure that the OPC UA server is enabled. See Automation Studio help for more details. Switch to the configuration view in the existing project and open the OPC UA configuration Select the variable \u201cmappRemoteShell\u201d, If the variables does not show up, save and compile the project, then reopen the window Enable the variables with the green checkmark Set \u201cAutomatic Enable\u201d to true in the properties window Start the python script To start the python script switch to the logical view. Right click on the script folder and select \"Open with Explorer\" Double click on the file start.pyw","title":"PLC Import"},{"location":"import.html#copy-task-to-new-project","text":"Open the demo project and the exiting project side by side. Go to the logical view in both projects. Copy the package mappRemoteShell from the demo project. Paste the task into the existing project at the top. Assign the new task to the CPU. The task is assign to task class #4 by default. Recommended task class is #8.","title":"Copy task to new project"},{"location":"import.html#enable-opc-ua-configuration","text":"Make sure that the OPC UA server is enabled. See Automation Studio help for more details. Switch to the configuration view in the existing project and open the OPC UA configuration Select the variable \u201cmappRemoteShell\u201d, If the variables does not show up, save and compile the project, then reopen the window Enable the variables with the green checkmark Set \u201cAutomatic Enable\u201d to true in the properties window","title":"Enable OPC UA configuration"},{"location":"import.html#start-the-python-script","text":"To start the python script switch to the logical view. Right click on the script folder and select \"Open with Explorer\" Double click on the file start.pyw","title":"Start the python script"},{"location":"installation.html","text":"Download and install Python from https://www.python.org/ Start the installation, set checkboxes, customize installation, restart the system to make sure that the path information are in affect. Open a command window and execute the following commands to install the required packages pip3 install PyQt5 pip3 install asyncua pip3 install timeloop pip3 install ConfigParser Copy the folder \\Logical\\mappRemoteShell\\PythonScript to the target PC. Change the config.ini file as needed. Run the file start.pyw from the PythonScript folder","title":"PC Installation"},{"location":"revision.html","text":"Version 0.5 Python Script: Better error handling when task or variable dont exist on PLC New documentation Version 0.4 Python Script: Added task and variable name to config.ini Python Script: Added ip and port to config.ini Python Script: Switched to new asyncua library Automation Studio: Update sample to mapp 5.15 Version 0.3 Support for command response to PLC Detailed error text when command fails to PLC Python window is now resizable Bug fixes and code cleanup Version 0.1 First release","title":"Revision"},{"location":"revision.html#version-05","text":"Python Script: Better error handling when task or variable dont exist on PLC New documentation","title":"Version 0.5"},{"location":"revision.html#version-04","text":"Python Script: Added task and variable name to config.ini Python Script: Added ip and port to config.ini Python Script: Switched to new asyncua library Automation Studio: Update sample to mapp 5.15","title":"Version 0.4"},{"location":"revision.html#version-03","text":"Support for command response to PLC Detailed error text when command fails to PLC Python window is now resizable Bug fixes and code cleanup","title":"Version 0.3"},{"location":"revision.html#version-01","text":"First release","title":"Version 0.1"},{"location":"wiki.html","text":"Sample Commands Here are a few examples that can be used as a command string. Start Windows file explorer explorer.exe Start Automation Studio C:\\BrAutomation\\AS47\\Bin-en\\AutomationStudio.exe Start Power Shell script with parameter powershell C:\\Temp\\GoogleRoute.ps1 Change task name or variable In some cases it can be neccessary to change the task or variable struture names. This can be the case if the script should control more than one PC. In this case the task must be duplicated. Duplicate task Rename the existing task mpRemote to mpRemote1. The copy and paste the task at the same location. This should automatically create mpRemote2. Switch to the physical view and add the task mpRemote2. Change OPC UA configuration Make sure that the OPC UA server is enabled. See Automation Studio help for more details. Switch to the configuration view in the existing project and open the OPC UA configuration Select the variable \u201cmappRemoteShell\u201d in mpReamote1 and mpRemote2, If the variables does not show up, save and compile the project, then reopen the window Enable the variables with the green checkmark Set \u201cAutomatic Enable\u201d to true in the properties window If the old task mpRemote still exists in the OPC configuration delete it Change the Python script configuration To change the Python script configuration switch to the logical view. Right click on the script folder and select \"Open with Explorer\". Open the file config.ini and change the parameter task to new task name mpRemote1 on the first PC and to mpRemote2 on the second PC.","title":"Wiki"},{"location":"wiki.html#sample-commands","text":"Here are a few examples that can be used as a command string. Start Windows file explorer explorer.exe Start Automation Studio C:\\BrAutomation\\AS47\\Bin-en\\AutomationStudio.exe Start Power Shell script with parameter powershell C:\\Temp\\GoogleRoute.ps1","title":"Sample Commands"},{"location":"wiki.html#change-task-name-or-variable","text":"In some cases it can be neccessary to change the task or variable struture names. This can be the case if the script should control more than one PC. In this case the task must be duplicated.","title":"Change task name or variable"},{"location":"wiki.html#duplicate-task","text":"Rename the existing task mpRemote to mpRemote1. The copy and paste the task at the same location. This should automatically create mpRemote2. Switch to the physical view and add the task mpRemote2.","title":"Duplicate task"},{"location":"wiki.html#change-opc-ua-configuration","text":"Make sure that the OPC UA server is enabled. See Automation Studio help for more details. Switch to the configuration view in the existing project and open the OPC UA configuration Select the variable \u201cmappRemoteShell\u201d in mpReamote1 and mpRemote2, If the variables does not show up, save and compile the project, then reopen the window Enable the variables with the green checkmark Set \u201cAutomatic Enable\u201d to true in the properties window If the old task mpRemote still exists in the OPC configuration delete it","title":"Change OPC UA configuration"},{"location":"wiki.html#change-the-python-script-configuration","text":"To change the Python script configuration switch to the logical view. Right click on the script folder and select \"Open with Explorer\". Open the file config.ini and change the parameter task to new task name mpRemote1 on the first PC and to mpRemote2 on the second PC.","title":"Change the Python script configuration"}]}